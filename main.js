$(window).on("load",function(){setTimeout(function(){$("#loader").fadeOut("slow")},2e3)});let loggedIn=!1;const logOutPanel=document.getElementById("log-out-main-menu"),loginPanel=document.getElementById("login-panel"),loginBox=document.getElementById("loginbox"),signUpPanel=document.getElementById("signupbox"),loginAlert=document.getElementById("login-alert"),signUpAlert=document.getElementById("signupalert");(function(){function c(){const v=j.value,w=l.value,x=firebase.auth(),y=x.signInWithEmailAndPassword(v,w);y.catch(()=>{showLoginAlert()})}function d(){const v=k.value,w=m.value,x=n.value,y=firebase.auth();y.createUserWithEmailAndPassword(v,w).then(z=>f(z,x,v,w,0)).catch(()=>{showSignUpAlert()})}function f(v,w,x,y,z){if(v){var A=firebase.database().ref(),B=A.child("users/"+v.uid);B.set({userName:w,email:x,password:y,score:z})}}function g(){menuBuild=!0,firebase.auth().signOut()}firebase.initializeApp({apiKey:"AIzaSyDLI2-ikgpZ8N4EX89enO8ERiMz63Rv7eo",authDomain:"fool-fall.firebaseapp.com",databaseURL:"https://fool-fall.firebaseio.com",projectId:"fool-fall",storageBucket:"fool-fall.appspot.com",messagingSenderId:"884200936745"});const j=document.getElementById("txtEmail"),k=document.getElementById("txtEmailSignUp"),l=document.getElementById("txtPassword"),m=document.getElementById("txtPasswordSignUp"),n=document.getElementById("txtUserName"),o=document.getElementById("btnLogin"),p=document.getElementById("btnSignUp"),q=document.getElementById("btnLogOut"),s=document.getElementById("btnLogOutMainMenu"),t=document.getElementById("goToSignUp"),u=document.getElementById("signinlink");j.addEventListener("touchend",function(){this.focus(),this.select()}),l.addEventListener("touchend",function(){this.focus(),this.select()}),k.addEventListener("touchend",function(){this.focus(),this.select()}),m.addEventListener("touchend",function(){this.focus(),this.select()}),n.addEventListener("touchend",function(){this.focus(),this.select()}),t.addEventListener("touchend",function(){$("#loginbox").hide(),$("#signupbox").show()}),u.addEventListener("touchend",function(){$("#signupbox").hide(),$("#loginbox").show()}),o.addEventListener("click",c),o.addEventListener("touchend",c),p.addEventListener("click",d),p.addEventListener("touchend",d),q.addEventListener("click",g),q.addEventListener("touchend",g),s.addEventListener("click",g),s.addEventListener("touchend",g),firebase.auth().onAuthStateChanged(v=>{if(v){q.classList.remove("hide"),loggedIn=!0;try{music.play(),loginPanel.style.display="none",signUpPanel.style.display="none"}catch(w){}logOutPanel.style.display="block",loginAlert.style.display="none",loginAlert.innerHTML="",displayScore(v)}else{q.classList.add("hide");try{music.pause(),loggedIn=!1,loginPanel.style.display="block",logOutPanel.style.display="none",loginBox.style.display="block"}catch(w){}}})})();function displayScore(c){var d=document.getElementById("welcomeUserInfo"),f=database.ref("users/"+c.uid);f.on("value",function(g){d.innerHTML="<p>Welcome <span class='inline-font'>"+g.child("userName").val()+"</span>, your highscore is <span style='color: #12ff19;' class='inline-font'>"+g.child("score").val()+"</span></p>"})}function showLoginAlert(){loginAlert.style.display="block",loginAlert.innerHTML="<p>Uh Oh! Unable to login. Are you sure that's your email and password?</p>"}function showSignUpAlert(){signUpAlert.style.display="block",signUpAlert.innerHTML="<p>Hmm, your email is improperly formatted. Can you make sure it's correct?</p>"}var database=firebase.database(),userData=[],i=0,scoresRef=firebase.database().ref("users").orderByKey();scoresRef.once("value").then(function(c){c.forEach(function(d){var f={},g=d.key,h=d.val();f.name=h.userName,f.score=h.score,userData[i]=f,i++})});var btnLeaderBoardExit=document.getElementById("btn-leader-board-exit"),btnMainMenuLeaderBoard=document.getElementById("btn-main-menu-leader-board"),btnMainMenuVolumeOn=document.getElementById("btn-main-menu-volume-on"),btnMainMenuVolumeOff=document.getElementById("btn-main-menu-volume-off"),btnPlay=document.getElementById("btn-main-menu-play"),leaderBoard=document.getElementById("leader-board"),instructions=document.getElementById("instructions"),randomFactBox=document.getElementById("random-fact"),logo=document.getElementById("game-header"),btnShare=document.getElementById("btn-main-menu-share"),welcomeUserInfo=document.getElementById("welcomeUserInfo");btnShare.addEventListener("click",shareBtn),btnShare.addEventListener("touchend",shareBtn);function shareBtn(){FB.ui({method:"share",href:"http://www.foodfall.ca"},function(){})}btnPlay.addEventListener("click",playBtn),btnPlay.addEventListener("touchend",playBtn);function playBtn(){playGameFromMenu(),menuSound.play("menu")}btnLeaderBoardExit.addEventListener("click",btnExitLeaderBoard),btnLeaderBoardExit.addEventListener("touchend",btnExitLeaderBoard);function btnExitLeaderBoard(){showMenu(),displayLogOutMainMenu(),logOutPanel.style.display="block",leaderBoard.style.display="none",btnMainMenuLeaderBoard.style.display="block"}btnMainMenuLeaderBoard.addEventListener("click",btnLeaderBoard),btnMainMenuLeaderBoard.addEventListener("touchend",btnLeaderBoard);function btnLeaderBoard(){document.getElementById("table-body").innerHTML="",updateLeader().done(function(){popLeaderboard()}),hideMenu(),logOutPanel.style.display="none",leaderBoard.style.display="block",btnMainMenuLeaderBoard.style.display="none"}function updateLeader(){var c=$.Deferred();return c.resolve(dumpScores()),c.promise()}btnMainMenuVolumeOn.addEventListener("click",btnVolumeOff),btnMainMenuVolumeOn.addEventListener("touchend",btnVolumeOff);function btnVolumeOn(){unmuteSound(),btnMainMenuVolumeOn.style.display="inline-block",btnMainMenuVolumeOff.style.display="none"}btnMainMenuVolumeOff.addEventListener("click",btnVolumeOn),btnMainMenuVolumeOff.addEventListener("touchend",btnVolumeOn);function btnVolumeOff(){muteSound(),btnMainMenuVolumeOn.style.display="none",btnMainMenuVolumeOff.style.display="inline-block"}var GAME_WIDTH=800,GAME_HEIGHT=500,slowDown=0.2,backgroundScrollSpeed={mtnFar:-0.7,mtnMid:-0.45,clouds:-0.45,trees:-0.2,grass:0.5,obstacle:1.3},BG_RATE=50,sky,mtnFar,mtnMid,ground,clouds,trees,grass,lastTime,Container=PIXI.Container,autoDetectRenderer=PIXI.autoDetectRenderer,loader=PIXI.loader,resources=PIXI.loader.resources,Sprite=PIXI.Sprite,myView=document.getElementById("myCanvas"),rendererOptions={antiAliasing:!1,transparent:!1,resolution:window.devicePixelRatio,autoResize:!0},renderer=autoDetectRenderer(GAME_WIDTH,GAME_HEIGHT,myView,rendererOptions),stage=new Container;renderer.view.style.position="absolute",renderer.view.style.top="0px",renderer.view.style.left="0px",document.getElementById("game-window").appendChild(renderer.view);var font=new Font;font.fontFamily="LemonMilk",font.src=font.fontFamily;var catcher,tk,scale=scaleToWindow(renderer.view),setupDone=!1,pointer,gameBuild=!0,menuBuild,catcherBuild,soundOptions={soundEnabled:!1,soundButtonOnDisplayed:!0,soundButtonOffDisplayed:!1},soundButtonOn,soundButtonOff,gameOverBuild,menuButton,retryButton,gameOverBanner,renderTexture,renderTexture2,currentTexture,outputSprite,stuffContainer=new PIXI.Container,spinningItems=[],profs=["albert","bruce","carly","chris","keith","medhat","paul","peter","sam","trevor"],cowLevelElapsedTime,portal,numberOfFood=6;apple={name:"apple",weight:1/numberOfFood,scoreValue:10,isCaught:!1,isHitBasket:!1},banana={name:"banana",weight:1/numberOfFood,scoreValue:10,isCaught:!1,isHitBasket:!1},bread={name:"bread",weight:1/numberOfFood,scoreValue:10,isCaught:!1,isHitBasket:!1},orange={name:"orange",weight:1/numberOfFood,scoreValue:10,isCaught:!1,isHitBasket:!1},broccoli={name:"broccoli",weight:1/numberOfFood,scoreValue:10,isCaught:!1,isHitBasket:!1},egg={name:"egg",weight:1/numberOfFood,scoreValue:10,isCaught:!1,isHitBasket:!1},fallingObjects=[apple,banana,bread,orange,broccoli,egg];var state;firebase.auth().onAuthStateChanged(c=>{state=c?menu:login}),menuBuild=!0,catcherBuild=!1,cowLevelBuild=!0,loader.add(["assets/img/sprites/basket.png","assets/img/sprites/apple.png","assets/img/sprites/banana.png","assets/img/sprites/bread.png","assets/img/sprites/broccoli.png","assets/img/sprites/egg.png","assets/img/sprites/cd-1.png","assets/img/sprites/cd-2.png","assets/img/sprites/cd-3.png","assets/img/sprites/cd-go.png","assets/img/sprites/orange.png","assets/img/sprites/play.png","assets/img/web/site-logo-white-long-shadow.png","assets/img/sprites/obstacle.png","assets/img/tiling-sprites/sky.png","assets/img/tiling-sprites/mtn-far.png","assets/img/tiling-sprites/mtn-mid.png","assets/img/tiling-sprites/ground.png","assets/img/tiling-sprites/clouds.png","assets/img/tiling-sprites/trees.png","assets/img/tiling-sprites/grass.png","assets/img/sprites/sound-on.png","assets/img/sprites/sound-off.png","assets/img/sprites/game-over.png","assets/img/sprites/retry.png","assets/img/sprites/menu.png","assets/img/sprites/portal.json","assets/img/sprites/profs.json","assets/img/sprites/cow-level-banner.png","assets/img/sprites/text-box.png"]).load(setup);function initBackground(){sky=new PIXI.extras.TilingSprite(resources["assets/img/tiling-sprites/sky.png"].texture,GAME_WIDTH,GAME_HEIGHT),mtnFar=new PIXI.extras.TilingSprite(resources["assets/img/tiling-sprites/mtn-far.png"].texture,GAME_WIDTH,GAME_HEIGHT),mtnMid=new PIXI.extras.TilingSprite(resources["assets/img/tiling-sprites/mtn-mid.png"].texture,GAME_WIDTH,GAME_HEIGHT),ground=new PIXI.extras.TilingSprite(resources["assets/img/tiling-sprites/ground.png"].texture,GAME_WIDTH,GAME_HEIGHT),clouds=new PIXI.extras.TilingSprite(resources["assets/img/tiling-sprites/clouds.png"].texture,GAME_WIDTH,GAME_HEIGHT),trees=new PIXI.extras.TilingSprite(resources["assets/img/tiling-sprites/trees.png"].texture,GAME_WIDTH,GAME_HEIGHT),grass=new PIXI.extras.TilingSprite(resources["assets/img/tiling-sprites/grass.png"].texture,GAME_WIDTH,GAME_HEIGHT),stage.addChild(sky),stage.addChild(mtnFar),stage.addChild(mtnMid),stage.addChild(ground),stage.addChild(clouds),stage.addChild(trees),stage.addChild(grass),lastTime=new Date().getTime()}function animateBackground(){var c=new Date().getTime(),d=(c-lastTime)/1e3;mtnFar.tilePosition.x-=BG_RATE*d+backgroundScrollSpeed.mtnFar,mtnMid.tilePosition.x-=BG_RATE*d+backgroundScrollSpeed.mtnMid,clouds.tilePosition.x-=BG_RATE*d+backgroundScrollSpeed.clouds,trees.tilePosition.x-=BG_RATE*d+backgroundScrollSpeed.trees,grass.tilePosition.x-=BG_RATE*d+backgroundScrollSpeed.grass,lastTime=c}function setup(){tk=new Tink(PIXI,renderer.view,scale),initBackground(),pointer=tk.makePointer(),pointer.press=function(){},pointer.release=function(){},setupDone=!0,window.addEventListener("resize",function(){tk.scale=scaleToWindow(renderer.view)}),$(window).on("orientationchange",function(){tk.scale=scaleToWindow(renderer.view)}),renderer.render(stage),gameLoop(),scores=[],dumpScores()}function gameLoop(){requestAnimationFrame(gameLoop),state(),lastTime=new Date().getTime(),tk.update(),renderer.render(stage)}function login(){animateBackground(),loginDisplay(),hideMenu()}function loginDisplay(){loginPanel.style.display="block"}function loginHide(){try{loginPanel.style.display="none",signUpPanel.style.display="none"}catch(c){}}function play(){gameInit(),foodFall(),soundButtonDisplay(),animateBackground(),addScore()}function showMenu(){btnShare.style.display="block",btnPlay.style.display="block",btnMainMenuVolumeOn.style.display="inline-block",btnMainMenuLeaderBoard.style.display="block",logo.style.display="block",instructions.style.display="inline-block",randomFactBox.style.display="inline-block",welcomeUserInfo.style.display="inline-block"}function hideMenu(){btnPlay.style.display="none",btnMainMenuVolumeOn.style.display="none",btnMainMenuVolumeOff.style.display="none",btnMainMenuLeaderBoard.style.display="none",leaderBoard.style.display="none",instructions.style.display="none",randomFactBox.style.display="none",logo.style.display="none",btnShare.style.display="none",welcomeUserInfo.style.display="none"}function gameMenuDisplay(){menuBuild&&(showMenu(),initFacts(),menuBuild=!1,catcherBuild=!0)}function displayLogOutMainMenu(){loggedIn&&(logOutPanel.style.display="block")}function hideLogOutMainMenu(){logOutPanel.style.display="none"}function soundButtonDisplay(){soundOptions.soundButtonOnDisplayed&&!soundOptions.soundButtonOffDisplayed?!soundOptions.soundEnabled&&(soundButtonOn=new Sprite(resources["assets/img/sprites/sound-on.png"].texture),soundButtonOn.interactive=!0,soundButtonOn.width/=3,soundButtonOn.height/=3,soundButtonOn.x=GAME_WIDTH-soundButtonOn.width,soundOptions.soundEnabled=!0,soundOptions.soundButtonOnDisplayed=!1,soundOptions.soundButtonOffDisplayed=!1,soundButtonOn.on("pointerdown",()=>{muteSound(),soundOptions.soundEnabled=!1,soundOptions.soundButtonOnDisplayed=!1,soundOptions.soundButtonOffDisplayed=!0,stage.removeChild(soundButtonOn)}),stage.addChild(soundButtonOn),btnMainMenuVolumeOn.style.display="none"):!soundOptions.soundButtonOnDisplayed&&soundOptions.soundButtonOffDisplayed&&!soundOptions.soundEnabled&&(soundButtonOff=new Sprite(resources["assets/img/sprites/sound-off.png"].texture),soundButtonOff.interactive=!0,soundButtonOff.width/=3,soundButtonOff.height/=3,soundButtonOff.x=GAME_WIDTH-soundButtonOff.width,soundOptions.soundEnabled=!0,soundOptions.soundButtonOnDisplayed=!1,soundOptions.soundButtonOffDisplayed=!1,soundButtonOff.on("pointerdown",()=>{unmuteSound(),soundOptions.soundEnabled=!1,soundOptions.soundButtonOnDisplayed=!0,soundOptions.soundButtonOffDisplayed=!1,stage.removeChild(soundButtonOff)}),stage.addChild(soundButtonOff))}function playGameFromMenu(){state=play,loginHide(),hideMenu(),hideLogOutMainMenu()}function menu(){animateBackground(),gameMenuDisplay()}function initCatcher(){catcherBuild&&(catcher=new Sprite(resources["assets/img/sprites/basket.png"].texture),catcher.y=GAME_HEIGHT/2,catcher.x=GAME_WIDTH/2,catcher.vx=0,catcher.vy=0,catcher.accelerationX=0,catcher.accelerationY=0,catcher.frictionX=0.5,catcher.frictionY=0.5,catcher.speed=0.2,catcher.drag=0.98,catcher.anchor.x=0.5,catcher.anchor.y=0.5,catcher.interactive=!0,catcher.rotation=0,tk.makeDraggable(catcher),stage.addChild(catcher),catcherBuild=!1,catcher.on("pointermove",onOutOfBounds),catcher.on("pointerover",onOutOfBounds))}function onOutOfBounds(){0>catcher.x&&(catcher.x=0),catcher.x>GAME_WIDTH&&(catcher.x=GAME_WIDTH),0>catcher.y&&(catcher.y=0),catcher.y>GAME_HEIGHT&&(catcher.y=GAME_HEIGHT)}function initFacts(){var c=getRandomInt(0,13);randomFactBox.innerHTML="<h2 class=\"text-box-header\">Food Fact</h2><hr /><p>"+foodFacts[c]+"</p>"}function gameOver(){animateBackground(),gameOverDisplay()}function gameOverDisplay(){gameOverBuild&&(gameOverBanner=new Sprite(resources["assets/img/sprites/game-over.png"].texture),gameOverBanner.x=GAME_WIDTH/2-gameOverBanner.width/2,gameOverBanner.y=GAME_HEIGHT-4*gameOverBanner.height,retryButton=new Sprite(resources["assets/img/sprites/retry.png"].texture),retryButton.interactive=!0,retryButton.width/=2,retryButton.height/=2,retryButton.anchor.x=0.5,retryButton.x=GAME_WIDTH-retryButton.width,retryButton.y=GAME_HEIGHT-2*retryButton.height,menuButton=new Sprite(resources["assets/img/sprites/menu.png"].texture),menuButton.interactive=!0,menuButton.width/=2,menuButton.height/=2,menuButton.anchor.x=0.5,menuButton.x=GAME_WIDTH/3-menuButton.width/2,menuButton.y=GAME_HEIGHT-2*menuButton.height,score.x=GAME_WIDTH/2,score.y=GAME_HEIGHT/2-40,score.text=bbf,score.style.fontSize=100,score.style.fill="#12ff19",stage.addChild(retryButton),stage.addChild(gameOverBanner),stage.addChild(menuButton),stage.addChild(score),retryButton.on("pointerdown",()=>{playGameFromMenu(),stage.removeChild(retryButton),stage.removeChild(gameOverBanner),stage.removeChild(menuButton),stage.removeChild(score)}),retryButton.mouseover=function(){this.width*=1.25,this.height*=1.25},retryButton.mouseout=function(){this.width/=1.25,this.height/=1.25},menuButton.on("pointerdown",()=>{state=menu,menuBuild=!0,gameMenuDisplay(),logOutPanel.style.display="block",stage.removeChild(retryButton),stage.removeChild(gameOverBanner),stage.removeChild(menuButton),stage.removeChild(score),BG_RATE=50,scores=[],dumpScores()}),menuButton.mouseover=function(){this.width*=1.25,this.height*=1.25},menuButton.mouseout=function(){this.width/=1.25,this.height/=1.25},menuBuild=!1,catcherBuild=!0,gameOverBuild=!1)}function fuckUpBackground(){var c=new Date().getTime(),d=(c-lastTime)/1e3;mtnFar.tilePosition.x-=BG_RATE*d-5,mtnMid.tilePosition.x-=BG_RATE*d+3,clouds.tilePosition.x-=BG_RATE*d+4,trees.tilePosition.x-=BG_RATE*d+2,grass.tilePosition.x-=BG_RATE*d-6,lastTime=c}function cowLevel(){if(fuckUpBackground(),soundButtonDisplay(),addScore(),renderTexture=PIXI.RenderTexture.create(renderer.width,renderer.height),renderTexture2=PIXI.RenderTexture.create(renderer.width,renderer.height),currentTexture=renderTexture,outputSprite=new PIXI.Sprite(currentTexture),cowLevelBuild){addScore(),destroyOldObjects(),catcher.alpha=0,outputSprite.x=400,outputSprite.y=300,outputSprite.anchor.set(0.5),stage.addChild(outputSprite),stuffContainer.x=400,stuffContainer.y=300,stage.addChild(stuffContainer);for(let k=0; k<profs.length; k++){var c=new Sprite(resources["assets/img/sprites/profs.json"].textures[""+profs[k%profs.length]+".png"]);c.interactive=!0,c.on("pointerdown",()=>{bbf+=100,gameSFX.play("point")}),c.x=400*Math.random()-200,c.y=400*Math.random()-200,c.anchor.set(0.5),stuffContainer.addChild(c),spinningItems.push(c)}var d=0,f=[];for(let k=0; 7>k; k++)f.push(PIXI.Texture.fromFrame("portal_0000_Layer-7"+k+".png"));portal=new PIXI.extras.AnimatedSprite(f),portal.x=renderer.width/2,portal.y=renderer.height/2,portal.width*=2,portal.height*=2,portal.anchor.set(0.5),portal.animationSpeed=0.5,portal.play(),stage.addChild(portal),secretCowLevelBanner=new Sprite(resources["assets/img/sprites/cow-level-banner.png"].texture),secretCowLevelBanner.width/=2,secretCowLevelBanner.height/=2,secretCowLevelBanner.x=GAME_WIDTH/2-secretCowLevelBanner.width/2,secretCowLevelBanner.y=GAME_HEIGHT-1.5*secretCowLevelBanner.height,stage.addChild(secretCowLevelBanner),portalSFX.play("portal"),cowLevelBuild=!1,cowLevelElapsedTime=0}for(let k=0;k<spinningItems.length;k++){var c=spinningItems[k];c.rotation+=0.1}d+=0.02;var g=renderTexture;renderTexture=renderTexture2,renderTexture2=g,outputSprite.texture=renderTexture,stuffContainer.rotation-=0.01,outputSprite.scale.set(1+0.1*Math.sin(d));var h=new Date().getTime(),j=(h-lastTime)/10;if(cowLevelElapsedTime+=j,20<=cowLevelElapsedTime){for(let k in spinningItems)stuffContainer.removeChild(k);portalSFX.volume(0),stage.removeChild(stuffContainer),portal.destroy(),stage.removeChild(secretCowLevelBanner),state=play,renderer.render(stage),cowLevelEnd()}}function cowLevelEnd(){catcher.alpha=1,catcher.x=GAME_WIDTH/2-catcher.width/2,catcher.y=GAME_HEIGHT/2-catcher.height/2,basd=0,countDownIndex=0,foodCount=0,afterCountDown=!0,catcher.alpha=1,score.alpha=1}function speedUpGame(c){BG_RATE+=15*c}var scoreRef=firebase.database().ref("users").orderByKey(),scores=[];function dumpScores(){scoreRef.once("value").then(function(h){h.forEach(function(j){var k=j.key,l=j.child("userName").val(),m=j.child("score").val();scores.push({childName:l,childScore:m})})});for(var d=0; 8>d; d++)if(scores[d]===void 0){scores[d]={childName:"---",childScore:"0"}}scores.sort(function(h, j){return h.childScore===j.childScore?0:h.childScore>j.childScore?-1:1})}function popLeaderboard(){try{for(var c="",d=0;8>d;d++)c+="<tr><td>"+(d+1)+"</td>",c+="<td>"+scores[d].childName+"</td>",c+="<td>"+scores[d].childScore+"</td></tr>";c+="",document.getElementById("table-body").innerHTML=c,scores=[]}catch(f){}}var timerToBeDeleted=[];function weightedRand(c){var d,f=0,g=Math.random();for(d in c)if(f+=c[d].weight,g<=f)return d}function getRandomInt(c,d){return c=Math.ceil(c),d=Math.floor(d),Math.floor(Math.random()*(d-c))+c}function fadeOut(c,d){var g=setInterval(function(){0>c.alpha?(timerToBeDeleted.push(g),!c.isCaught&&c.isFood&&(--foodCount,c.destroy(),c.isCaught=!0)):c.alpha-=1/d},d/10)}function clearTimer(){for(var c=0;c<timerToBeDeleted.length;c++)clearInterval(timerToBeDeleted[c])}foodFacts=["Avoidable food waste is food that could have been eaten, but was thrown away instead.","Avoidable food waste includes uneaten leftovers or food that spoiled before it was used.","Reducing the food you buy is better than composting it!","Keep track of how much food you eat! Can you remember what you had for breakfast?","The main barrier to reducing food waste is a bad attitude!","Check out our other resources and affiliate apps to learn how to reduce food waste.","Every day, 30 000 eggs are thrown away in Metro Vancouver.","Every day, 80 000 potatoes are thrown away in Metro Vancouver.","Every day, 55 000 apples are thrown away in Metro Vancouver.","Every day, 70 000 glasses of milk are thrown away in Metro Vancouver.","Every day, 32 000 loaves of bread are thrown away in Metro Vancouver.","Vegetables and fruits are the most commonly wasted food \u2013 eat your veggies while they\u2019re fresh!","If you have a scale, try weighing your compost bags before you throw them out for a week. What\u2019s the average weight?","Try keeping track of what\u2019s in your fridge! See our affiliate Plenty of Thyme for an easy way to do this."];var gameSFX=new Howl({src:["assets/sound/SFX-8bit.mp3"],sprite:{point:[4600,1000],gameOver:[6000,1500]},volume:0.15}),menuSound=new Howl({src:["assets/sound/SFX-menu.wav"],sprite:{menu:[0,3000]},volume:0.25}),music=new Howl({src:["assets/sound/MUSIC-its-not-my-ship.mp3"],autoplay:!1,loop:!0,volume:0.5}),portalSFX=new Howl({src:["assets/sound/SFX-portal.mp3"],sprite:{portal:[0,10000]},volume:0.25,loop:!0});function muteSound(){music.pause(),gameSFX.volume(0),menuSound.volume(0),portalSFX.volume(0)}function unmuteSound(){music.play(),gameSFX.volume(0.5),menuSound.volume(0.5),portalSFX.volume(0.5)}var bbf=0,childrenToDelete=[];const foodFadeDuration=90,displayNoFadeDuration=100,pointFadeDuration=80,rgu=1,comboColors=["#fff","#ffb347","#d9c846","#40d97c ","#12ff19"],gkr=10;var lastXPos=0,lastYPos=0,skjef=0,caughtFood=[],eggCount=0,cowLevelHasBeenActivated=!1,score=new PIXI.Text(bbf,{fontSize:50,fontFamily:"LemonMilk",fill:"white"});function gameInit(){if(gameBuild){BG_RATE=50,basd=0,countDownIndex=0,foodCount=0,bbf=0,afterCountDown=!1;var c=new Sprite(resources["assets/img/sprites/cd-3.png"].texture),d=new Sprite(resources["assets/img/sprites/cd-2.png"].texture),f=new Sprite(resources["assets/img/sprites/cd-1.png"].texture),g=new Sprite(resources["assets/img/sprites/cd-go.png"].texture);countDownNumbers=[c,d,f,g],gameBuildTime=new Date().getTime(),comboMultiplier=1,isCombo=!1,numOfFoodFallen=0,skjef=0,isFirstRun=!0,initCatcher(),initComboDisplay(),BASKET_HEIGHT=catcher.height,BASKET_WIDTH=catcher.width,X_OFFSET=BASKET_WIDTH/2,Y_OFFSET=BASKET_HEIGHT/2,score.style.fontSize=50,score.style.fill="#fff"}gameBuild=!1}function displayNo(){if(!(4<=countDownIndex)){var c=countDownNumbers[countDownIndex];stage.addChild(c),c.x=100,c.y=50,fadeOut(c,displayNoFadeDuration),++countDownIndex}}function makeFood(){if(!(foodCount>=5)){++foodCount;var d=weightedRand(fallingObjects),f=PIXI.Sprite.fromImage("assets/img/sprites/"+fallingObjects[d].name+".png");f.name=fallingObjects[d],f.x=getRandomInt(f.width,GAME_WIDTH-f.width),f.y=-f.height,f.anchor.x=0.5,f.anchor.y=0.5,f.isFood=!0,f.velocityY=0,f.velocityX=0,f.accelerationY=210;var g=0.5<=Math.random();f.rotateFactor=g?0.1*Math.random():0.1*-Math.random(),++numOfFoodFallen,stage.addChild(f)}}function removeItem(c){stage.removeChild(c)}function isInBasket(c,d){var f=c.x-X_OFFSET,g=c.x+BASKET_WIDTH-X_OFFSET,h=c.y-Y_OFFSET,j=c.y+BASKET_HEIGHT-Y_OFFSET,k={x:f+10,y:h},l={x:g-10,y:h+30},m=d.y-d.height/2+5,n=d.x>k.x&&m>k.y&&d.x<l.x&&m<l.y;return n}function isBounce(c,d,f){var g=!1,h=d.x-d.width/2,j=d.x+d.width/2,k=d.y-d.height/2,l=d.y+d.height/2,m=c.x-X_OFFSET,n=c.x+BASKET_WIDTH-X_OFFSET,o=c.y-Y_OFFSET,p=c.y+BASKET_HEIGHT-Y_OFFSET,s=c.height/2,u=c.height/2,v=h<m,w=j>n;if(k<o&&l>o){if(v){g=0<f&&h>{x:m,y:o+20}.x}else if(w){g=0>f&&j<{x:n,y:o+20}.x}}else if(k>o&&l<p){if(v){g=0<f&&j>{x:m+10,y:s}.x}else if(w){g=0>f&&h<{x:n-10,y:u}.x}}else if(k<p&&l>p)if(v){g=0<f&&j>{x:m,y:p}.x}else if(w){g=0>f&&h<{x:n,y:p}.x}return g}function isBounceOffBottom(c, d){var f=d.y-d.height/2,g=c.y+BASKET_HEIGHT-Y_OFFSET;if(!(f>g))return!1;var j=c.x-X_OFFSET+10,k=c.x-X_OFFSET+BASKET_WIDTH-10,l=d.x;if(!(l>j&&l<k))return!1;var o=f>g&&f<g+20;return d.isBounceOffBottom=o,o}function velocityOfRotatingFruits(){for(var c=1; c<=numOfFoodFallen; c++)skjef+=5<=c?5*gkr:gkr*c;return skjef<bbf}function foodFall(){var c=new Date().getTime(),d=parseFloat((c-lastTime)/1e3),f=parseInt((c-gameBuildTime)/1e3),g=catcher.x,h=catcher.y;if(afterCountDown||f!=countDownIndex||(displayNo(),4==f&&(afterCountDown=!0)),afterCountDown){if(isFirstRun)var j=0;else var j=(lastXPos-g)/d;var k=(lastYPos-h)/d;for(var l in lastXPos=catcher.x,lastYPos=catcher.y,makeFood(),25>f?makeObstacle():makeTwoObstacles(),stage.children){var m=stage.children[l];if(m.isObstacle){var n=m;n.x<-n.width?(childrenToDelete.push(n),n.destroy(),--basd):(n.x-=BG_RATE*d+backgroundScrollSpeed.grass,obstacleCollision(catcher,n))}if(m.isFood){var o=m.velocityY*d,p=m.accelerationY*d;m.y+=o,m.x+=m.velocityX,m.velocityY+=m.isBounceOffBottom?m.newVelocityY:p,m.rotation+=m.rotateFactor;var q=m.y>GAME_HEIGHT||m.x>GAME_WIDTH||0>m.x;if(!m.isHitBasket&&q)decreaseScore(),makePointDecrementer(m),breakCombo(),childrenToDelete.push(m),m.destroy(),resetComboMulitplier(),updateComboDisplay(),--foodCount;else if(!m.isHitBasket&&isInBasket(catcher,m)){getFoodType(m);caughtFood.push(m.name),makePointIncrementer(catcher,m),modScore(m),increaseComboMultiplier(),updateComboDisplay(),fadeOutFood(m),isCowLevelCombo(),gameSFX.play("point"),stage.removeChild(score),m.isHitBasket=!0}else if(!m.isHitBasket&&isBounce(catcher,m,j)){var s=1e3/j;6<s?s=6:-6>s&&(s=-6),m.velocityX=-s}else if(!m.isHitBasket&&isBounceOffBottom(catcher,m)){var t=1e3/k;6<t?t=6:-6>t&&(t=-6),m.newVelocityY=m.velocityY/10+-t}}(m.isPointCounter||m.isPointDecrementer)&&(m.y-=3)}0==f%2&&speedUpGame(d),0==f%5&&clearCaughtFood();for(var l=0; l<childrenToDelete.length; l++)removeItem(childrenToDelete[l]);clearTimer(),tiltBasket(j),isFirstRun=!1}}function tiltBasket(c){var f=catcher.rotation,g;0.2<f?catcher.rotation=0.2:-0.2>f?catcher.rotation=-0.2:Math.floor(0==c)?0.01>f&&-0.01<f?catcher.rotation=0:0<f?(g=-0.04,catcher.rotation+=g):0>f&&(g=0.04,catcher.rotation+=g):catcher.rotation+=-c/3e4}function makeTwoObstacles(){if(!(basd>=rgu)){var c=new Sprite(resources["assets/img/sprites/obstacle.png"].texture);c.x=GAME_WIDTH,c.height=getRandomInt(30,2*(GAME_HEIGHT/3)),c.y=0,c.width=50,c.isObstacle=!0,stage.addChild(c);var d=new Sprite(resources["assets/img/sprites/obstacle.png"].texture);d.x=c.x,d.y=c.height+2*catcher.height,d.height=GAME_HEIGHT-d.y,d.width=c.width,d.isObstacle=!0,stage.addChild(d),basd+=2}}function makeObstacle(){if(!(basd>=rgu)){var c=0.5<=Math.random();if(c){var d=new Sprite(resources["assets/img/sprites/obstacle.png"].texture);d.x=GAME_WIDTH,d.height=getRandomInt(30,2*(GAME_HEIGHT/3)),d.y=0,d.width=50,d.isObstacle=!0,stage.addChild(d)}else{var f=new Sprite(resources["assets/img/sprites/obstacle.png"].texture);f.x=GAME_WIDTH,f.y=60+2*catcher.height,f.height=GAME_HEIGHT-f.y,f.width=50,f.isObstacle=!0,stage.addChild(f)}++basd}}function fadeOutFood(c){c.velocityY=10,c.rotateFactor=0,c.isHitBasket=!0,fadeOut(c,foodFadeDuration)}function obstacleCollision(c, d){isCollideObstacle(c,d)&&(endGame(),gameSFX.play("gameOver"),state=gameOver,gameOverBuild=!0,c.alpha=0)}function isCollideObstacle(c, d){return!(c.y+BASKET_HEIGHT-Y_OFFSET-15<d.y||c.y-Y_OFFSET+15>d.y+d.height||c.x+BASKET_WIDTH-X_OFFSET-15<d.x||c.x-X_OFFSET+15>d.x+d.width)}function addScore(){score.x=GAME_WIDTH-score.width,score.y=GAME_HEIGHT-(score.height+50),score.anchor.x=0.5,score.text=bbf,stage.addChild(score)}function addHighScore(c){firebase.auth().onAuthStateChanged(d=>{if(d){var f=firebase.database().ref("users/"+d.uid+"/score");f.on("value",function(g){if(c>g.val()){var h=firebase.database().ref("users/"+d.uid);h.update({score:c})}})}})}function endGame(){velocityOfRotatingFruits()&&(bbf=0),menuBuild=!0,gameBuild=!0,addHighScore(bbf),destroyOldObjects(),stage.removeChild(comboDisplay)}function makePointDecrementer(c){var d=new PIXI.Text("-10",{fontSize:50,fontFamily:"LemonMilk",fill:"#ff0005"});d.isPointDecrementer=!0,c.x>GAME_WIDTH?(d.x=GAME_WIDTH-d.width,d.y=c.y):0>c.x?(d.x=10,d.y=c.y):(d.y=GAME_HEIGHT-10,d.x=c.x),stage.addChild(d),fadeOut(d,pointFadeDuration)}function makePointIncrementer(c, d){var f=new PIXI.Text("+"+comboMultiplier*d.name.scoreValue,{fontSize:50,fontFamily:"LemonMilk",fill:"#12ff19"});f.isPointCounter=!0,f.x=d.x,f.y=c.y-c.height,stage.addChild(f),fadeOut(f,pointFadeDuration)}function destroyOldObjects(){for(var c in stage.children){var d=stage.children[c],f=d.isFood||d.isObstacle||"score"==d.name;f&&childrenToDelete.push(stage.children[c])}for(var c=0; c<childrenToDelete.length; c++)removeItem(childrenToDelete[c]),childrenToDelete[c].destroy()}function getFoodType(c){return c.name}function clearCaughtFood(){caughtFood.length=0}function modScore(c){var d=getFoodType(c);bbf+=comboMultiplier*d.scoreValue}function decreaseScore(){0<bbf&&(bbf-=10),0>bbf&&(bbf=0)}function increaseComboMultiplier(){5==comboMultiplier||(comboMultiplier+=1)}function resetComboMulitplier(){comboMultiplier=1}function breakCombo(){isCombo=!1,comboMultiplier=1}function initComboDisplay(){var c=comboColors[comboMultiplier-1];comboDisplay=new PIXI.Text(comboMultiplier+"x",{fontSize:50,fontFamily:"LemonMilk",fill:c}),comboDisplay.name="comboDisplay",comboDisplay.x=GAME_WIDTH-70,comboDisplay.y=GAME_HEIGHT-200,stage.addChild(comboDisplay)}function updateComboDisplay(){comboDisplay.text=comboMultiplier+"x",comboDisplay.style.fill=comboColors[comboMultiplier-1]}function isCowLevelCombo(){for(i=0;i<caughtFood.length;i++)if("egg"===caughtFood[i]?eggCount++:eggCount=0,10<=eggCount)return eggCount=0,cowLevelHasBeenActivated||(cowLevelBuild=!0,state=cowLevel,cowLevelHasBeenActivated=!cowLevelHasBeenActivated),!0;return!1}